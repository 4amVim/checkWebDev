<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <title>A trivial todo web-thingy.</title>
    <link href="styles/style.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


</head>

<body>

    <!-- Define Color classes -->
    <script>
        for ( i = 1; i <= 4; i++ ) {
            //Can be made slightly better by making into a map function that applies a lambda like follows ?
            //      const colorVars=['--surface','--card','--blurb'];
            //      colorVars.forEach(function(yoyo){});
            var styleHeading = document.createElement( 'style' );
            styleHeading.innerHTML = `#list${ i } { background-color: var(--surface${ i });}`;
            document.body.appendChild( styleHeading );

            var styleCard = document.createElement( 'style' );
            styleCard.innerHTML = `.card${ i } { background-color: var(--card${ i }); }`;
            document.body.appendChild( styleCard );

            var styleText = document.createElement( 'style' );
            styleText.innerHTML = `.title${ i } { color: var(--blurb${ i });}`;
            document.body.appendChild( styleText );
        }
    </script>


    <div id="list1">
        <h1 class="title1">Chores</h1>
    </div>

    <div id="list2">
        <h1 class="title2">Work</h1>
    </div>

    <div id="list3">
        <h1 class="title3">Critical</h1>
    </div>

    <div id="list4">
        <h1 class="title4">Misc</h1>
    </div>

<!-- Fetch and draw lists -->
    <script>

        fetch(
    "https://firestore.googleapis.com/v1/projects/small-todo/databases/(default)/documents/main/pika",
    { method: 'GET' }
).then( function ( response ) {
    if(response.status==200){
    // The API call was successful!
    response.json().then( ( data ) => {
        function trying ( key, value,id) {
            var foo = document.getElementById(`list${id}`);

            console.log( `key ${ key }` );
            console.log( `value ${ value }` );

            var fofo = document.createElement( 'div' )

            var bar = document.createElement( 'p' );
            var text = document.createTextNode( key );

            bar.appendChild( text );
            fofo.appendChild( bar );




            var card = fofo;
            card.setAttribute( 'class', `card${id}` );
            foo.appendChild( card );

        }

        extractList( 'Chores', data, trying );
        extractList( 'Work', data, trying );
        extractList( 'Critical', data, trying );
        extractList( 'Misc', data, trying );
    } );
}else{
            var errorHeading =document.createElement('h3');
            errorHeading.setAttribute('style','color:white; top:20%; position:absolute; text-align:center; width:100%')
        errorHeading.textContent="Apologies, but something isn't quite right";
        document.body.innerHTML="";
        document.body.appendChild(errorHeading);

}
} )
    .catch( function ( err ) {
        // There was an error
        console.warn( "Something went wrong.", err );
        var errorHeading =document.createElement('h3');
        errorHeading.textContent=err;
        document.body.appendChild(errorHeading);

    } );


    </script>

        <script src="scripts/main.js"></script>
</body>
